 <!DOCTYPE html>

<html lang="vi">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

<title>Flappy God Mode - Audio Ver</title>

<style>

body {

margin: 0; overflow: hidden; background: #020205;

font-family: 'Courier New', Courier, monospace;

touch-action: none; user-select: none; -webkit-touch-callout: none;

}

canvas { display: block; }

#score-board {

position: absolute; top: 10%; width: 100%;

text-align: center; font-size: 60px; font-weight: bold;

color: white; z-index: 10; pointer-events: none;

text-shadow: 0 0 10px #00f3ff;

}

#game-over {

position: absolute; top: 50%; left: 50%;

transform: translate(-50%, -50%);

text-align: center; display: none;

background: rgba(0, 0, 0, 0.9); padding: 30px;

border: 2px solid #ff0055; border-radius: 15px;

box-shadow: 0 0 30px #ff0055; z-index: 20;

}

h1 { margin: 0 0 10px 0; color: #ff0055; font-size: 40px; }

button {

padding: 15px 40px; font-size: 24px; background: #00f3ff;

border: none; border-radius: 50px; cursor: pointer;

font-weight: bold; box-shadow: 0 0 15px #00f3ff; font-family: inherit;

}

#start-msg {

position: absolute; top: 60%; width: 100%; text-align: center;

color: rgba(255,255,255,0.5); font-size: 16px; pointer-events: none;

animation: blink 1.5s infinite;

line-height: 1.5;

}

@keyframes blink { 50% { opacity: 0.2; } }

</style>

</head>

<body>


<div id="score-board">0</div>

<div id="start-msg">CHẠM ĐỂ BẮT ĐẦU<br>(Bật âm thanh lên nhé!)</div>

<div id="game-over">

<h1>GAME OVER</h1>

<p style="color:white">Điểm: <span id="final-score">0</span></p>

<button onclick="resetGame()">CHƠI LẠI</button>

</div>

<canvas id="gameCanvas"></canvas>


<script>

const canvas = document.getElementById('gameCanvas');

const ctx = canvas.getContext('2d');

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }

window.addEventListener('resize', resize); resize();


let frames = 0;

let score = 0;

let gameState = 'START';

let particles = [];

let bullets = [];

let gunItems = [];

let shieldItems = [];


// --- BỘ GIẢ LẬP ÂM THANH (AUDIO SYNTHESIZER) ---

const AudioSys = {

ctx: null,

init: function() {

if (!this.ctx) {

this.ctx = new (window.AudioContext || window.webkitAudioContext)();

}

if (this.ctx.state === 'suspended') {

this.ctx.resume();

}

},

playTone: function(freq, type, duration, vol=0.1) {

if (!this.ctx) return;

const osc = this.ctx.createOscillator();

const gain = this.ctx.createGain();

osc.type = type; // 'sine', 'square', 'sawtooth', 'triangle'

osc.frequency.setValueAtTime(freq, this.ctx.currentTime);

gain.gain.setValueAtTime(vol, this.ctx.currentTime);

gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + duration);


osc.connect(gain);

gain.connect(this.ctx.destination);

osc.start();

osc.stop(this.ctx.currentTime + duration);

},

// Các hiệu ứng cụ thể

sfxShoot: function() { // Tiếng bắn laser (tần số giảm nhanh)

if (!this.ctx) return;

const osc = this.ctx.createOscillator();

const gain = this.ctx.createGain();

osc.type = 'sawtooth';

osc.frequency.setValueAtTime(800, this.ctx.currentTime);

osc.frequency.exponentialRampToValueAtTime(100, this.ctx.currentTime + 0.1);

gain.gain.setValueAtTime(0.1, this.ctx.currentTime);

gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.1);

osc.connect(gain); gain.connect(this.ctx.destination);

osc.start(); osc.stop(this.ctx.currentTime + 0.1);

},

sfxJump: function() { // Tiếng nhảy

this.playTone(400, 'sine', 0.1, 0.1);

},

sfxExplode: function() { // Tiếng nổ (trầm, ồn)

if (!this.ctx) return;

const osc = this.ctx.createOscillator();

const gain = this.ctx.createGain();

osc.type = 'square';

osc.frequency.setValueAtTime(100, this.ctx.currentTime);

osc.frequency.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);

gain.gain.setValueAtTime(0.2, this.ctx.currentTime);

gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);

osc.connect(gain); gain.connect(this.ctx.destination);

osc.start(); osc.stop(this.ctx.currentTime + 0.3);

},

sfxItem: function() { // Tiếng ăn đồ (cao, sáng)

this.playTone(1200, 'sine', 0.1, 0.1);

setTimeout(() => this.playTone(1800, 'sine', 0.2, 0.1), 50);

},

sfxDie: function() { // Tiếng chết

if (!this.ctx) return;

const osc = this.ctx.createOscillator();

const gain = this.ctx.createGain();

osc.type = 'triangle';

osc.frequency.setValueAtTime(300, this.ctx.currentTime);

osc.frequency.linearRampToValueAtTime(50, this.ctx.currentTime + 0.5);

gain.gain.setValueAtTime(0.2, this.ctx.currentTime);

gain.gain.linearRampToValueAtTime(0.01, this.ctx.currentTime + 0.5);

osc.connect(gain); gain.connect(this.ctx.destination);

osc.start(); osc.stop(this.ctx.currentTime + 0.5);

}

};


// --- BOSS RẮN ---

const snakeBoss = {

active: false, timer: 600, segments: [], baseY: 0, waveOffset: 0, textStr: "BÌNH PRO", spacing: 35,

spawn: function() {

this.active = true; this.segments = []; this.baseY = canvas.height / 2; this.waveOffset = 0;

for(let i=0; i<this.textStr.length; i++) {

this.segments.push({ char: this.textStr[i], x: canvas.width + i * this.spacing, y: this.baseY, alive: true });

}

},

updateAndDraw: function() {

if (!this.active) {

if (this.timer > 0) this.timer--; else { this.spawn(); this.timer = 1000; }

return;

}

this.waveOffset += 0.1; let allOffScreen = true;

ctx.font = "bold 30px 'Courier New', monospace"; ctx.textAlign = "center"; ctx.textBaseline = "middle";


this.segments.forEach((seg, index) => {

seg.x -= 2.5; seg.y = this.baseY + Math.sin(this.waveOffset + index * 0.5) * 60;

if (seg.x > -100) allOffScreen = false;


if (seg.alive) {

ctx.fillStyle = `hsl(${(frames*2 + index*20)%360}, 100%, 70%)`;

ctx.shadowBlur = 20; ctx.shadowColor = ctx.fillStyle;

ctx.fillText(seg.char, seg.x, seg.y); ctx.shadowBlur = 0;


let dist = Math.hypot(bird.x - seg.x, bird.y - seg.y);

let hitRadius = bird.shieldTimer > 0 ? 50 : bird.radius + 15;


if (dist < hitRadius) {

if (bird.shieldTimer > 0) {

seg.alive = false;

createExplosion(seg.x, seg.y, 'rainbow', 40);

AudioSys.sfxExplode(); // Âm thanh nổ

score += 5; document.getElementById('score-board').innerText = score;

} else {

gameOver();

}

}

}

});

if (allOffScreen) this.active = false;

}

};


// --- CON CHIM ---

const bird = {

x: 50, y: 150, w: 30, h: 30, radius: 15,

speed: 0, gravity: 0.25, jump: 4.6, rotation: 0,

gunTimer: 0, shieldTimer: 0,


draw: function() {

ctx.save();

ctx.translate(this.x, this.y);

if (this.shieldTimer > 0) {

ctx.save(); ctx.rotate(frames * 0.1);

ctx.beginPath(); ctx.arc(0, 0, 45, 0, Math.PI * 2);

ctx.lineWidth = 3; ctx.strokeStyle = `hsl(${frames % 360}, 100%, 50%)`;

ctx.shadowBlur = 20; ctx.shadowColor = '#fff'; ctx.stroke();

ctx.rotate(frames * -0.2);

ctx.beginPath(); ctx.arc(0, 0, 35, 0, Math.PI * 1.5);

ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke(); ctx.restore();

}

this.rotation = Math.min(Math.PI / 4, Math.max(-Math.PI / 4, (this.speed * 0.1)));

ctx.rotate(this.rotation);

ctx.fillStyle = '#ffcc00'; ctx.shadowBlur = 15; ctx.shadowColor = '#ffcc00'; ctx.fillRect(-this.w/2, -this.h/2, this.w, this.h);

ctx.fillStyle = '#000'; ctx.shadowBlur = 0; ctx.fillRect(5, -10, 8, 8);

ctx.fillStyle = '#fff'; ctx.fillRect(-10, 2, 12, 6);

if (this.gunTimer > 0) { ctx.fillStyle = '#ff0000'; ctx.fillRect(5, 5, 20, 8); ctx.fillStyle = '#555'; ctx.fillRect(5, 5, 5, 12); }

ctx.restore();

if (this.gunTimer > 0) { let gw = (this.gunTimer / 600) * 40; ctx.fillStyle = '#00ff00'; ctx.fillRect(this.x - 20, this.y - 40, gw, 4); }

if (this.shieldTimer > 0) { let sw = (this.shieldTimer / 600) * 40; ctx.fillStyle = '#00ffff'; ctx.fillRect(this.x - 20, this.y - 35, sw, 4); }

},

update: function() {

this.speed += this.gravity; this.y += this.speed;

if (this.y + this.h/2 >= canvas.height) { this.y = canvas.height - this.h/2; gameOver(); }

if (this.y - this.h/2 <= 0) { this.y = this.h/2; this.speed = 0; }

if (this.gunTimer > 0) this.gunTimer--;

if (this.shieldTimer > 0) this.shieldTimer--;

},

flap: function() {

this.speed = -this.jump;

AudioSys.sfxJump(); // Âm thanh nhảy

if (this.gunTimer > 0) {

bullets.push({ x: this.x + 10, y: this.y + 5, vx: 10, hue: 0 });

AudioSys.sfxShoot(); // Âm thanh bắn

}

},

addGun: function() { this.gunTimer = 600; },

addShield: function() { this.shieldTimer = 600; }

};


// --- ỐNG CỐNG ---

const pipes = {

position: [], w: 60, gap: 170, dx: 3,

draw: function() {

for(let i = 0; i < this.position.length; i++) {

let p = this.position[i];

ctx.shadowBlur = 10; ctx.shadowColor = '#00f3ff';

if (!p.brokenTop) {

ctx.fillStyle = '#00f3ff'; ctx.fillRect(p.x, 0, this.w, p.y);

ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.shadowBlur = 0; ctx.strokeRect(p.x, 0, this.w, p.y);

}

if (!p.brokenBottom) {

let botY = p.y + this.gap;

ctx.shadowBlur = 10; ctx.shadowColor = '#00f3ff'; ctx.fillStyle = '#00f3ff';

ctx.fillRect(p.x, botY, this.w, canvas.height - botY);

ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.shadowBlur = 0; ctx.strokeRect(p.x, botY, this.w, canvas.height - botY);

}

}

},

update: function() {

if (snakeBoss.active) {

for(let i = 0; i < this.position.length; i++) {

this.position[i].x -= this.dx;

if(this.position[i].x + this.w < 0) { this.position.shift(); i--; }

}

return;

}

if (frames % 120 == 0) {

let maxY = canvas.height - 150 - this.gap; let minY = 50;

let y = Math.floor(Math.random() * (maxY - minY + 1) + minY);

this.position.push({ x: canvas.width, y: y, passed: false, brokenTop: false, brokenBottom: false });

let rand = Math.random();

if (rand < 0.2) gunItems.push({ x: canvas.width + 30, y: y + this.gap / 2, size: 25, active: true });

else if (rand > 0.8) shieldItems.push({ x: canvas.width + 30, y: y + this.gap / 2, size: 25, active: true });

}


for(let i = 0; i < this.position.length; i++) {

let p = this.position[i]; p.x -= this.dx;

if(p.x + this.w < 0) { this.position.shift(); score++; document.getElementById('score-board').innerText = score; if(score % 5 == 0) this.dx += 0.2; i--; }

if (bird.x + bird.w/2 + 20 > p.x && bird.x - bird.w/2 - 20 < p.x + this.w) {

if ((bird.y - bird.h/2 - (bird.shieldTimer>0?20:0) < p.y) && !p.brokenTop) {

if (bird.shieldTimer > 0) { p.brokenTop = true; createExplosion(bird.x, p.y, '#00f3ff', 30); AudioSys.sfxExplode(); }

else gameOver();

}

if ((bird.y + bird.h/2 + (bird.shieldTimer>0?20:0) > p.y + this.gap) && !p.brokenBottom) {

if (bird.shieldTimer > 0) { p.brokenBottom = true; createExplosion(bird.x, p.y + this.gap, '#00f3ff', 30); AudioSys.sfxExplode(); }

else gameOver();

}

}

}

},

reset: function() { this.position = []; this.dx = 3; }

};


function updateItems(items, type) {

for(let i = 0; i < items.length; i++) {

let g = items[i]; g.x -= pipes.dx;

if (g.active) {

let pulse = Math.sin(frames * 0.1) * 5;

ctx.shadowBlur = 20;

if (type === 'gun') {

ctx.fillStyle = '#ff0000'; ctx.shadowColor = '#ff0000';

ctx.fillRect(g.x - g.size/2, g.y - g.size/2 + pulse, g.size, g.size);

ctx.fillStyle = '#fff'; ctx.font = 'bold 20px Arial'; ctx.textAlign = 'center'; ctx.fillText('G', g.x, g.y + pulse + 7);

} else {

ctx.fillStyle = '#00ffff'; ctx.shadowColor = '#00ffff';

ctx.beginPath(); ctx.arc(g.x, g.y + pulse, g.size/2 + 2, 0, Math.PI*2); ctx.fill();

ctx.fillStyle = '#000'; ctx.font = 'bold 20px Arial'; ctx.textAlign = 'center'; ctx.fillText('O', g.x, g.y + pulse + 7);

}

if (Math.hypot(bird.x - g.x, bird.y - (g.y + pulse)) < bird.w + g.size/2) {

g.active = false;

if (type === 'gun') bird.addGun(); else bird.addShield();

createExplosion(g.x, g.y, type==='gun'?'#00ff00':'#fff', 20);

AudioSys.sfxItem(); // Âm thanh ăn đồ

}

}

if (g.x < -50) { items.splice(i, 1); i--; }

}

}


function updateBullets() {

for(let i = 0; i < bullets.length; i++) {

let b = bullets[i]; b.x += b.vx; b.hue = (b.hue + 10) % 360;

ctx.fillStyle = `hsl(${b.hue}, 100%, 50%)`; ctx.shadowBlur = 10; ctx.shadowColor = ctx.fillStyle;

ctx.beginPath(); ctx.arc(b.x, b.y, 6, 0, Math.PI*2); ctx.fill();

let hit = false;

pipes.position.forEach(p => {

if (b.x > p.x && b.x < p.x + pipes.w && !hit) {

if (b.y < p.y && !p.brokenTop) { p.brokenTop = true; createExplosion(b.x, p.y, '#00f3ff', 30); AudioSys.sfxExplode(); hit = true; }

else if (b.y > p.y + pipes.gap && !p.brokenBottom) { p.brokenBottom = true; createExplosion(b.x, p.y + pipes.gap, '#00f3ff', 30); AudioSys.sfxExplode(); hit = true; }

}

});

if (snakeBoss.active && !hit) {

snakeBoss.segments.forEach(seg => {

if (seg.alive && !hit && b.x > seg.x-15 && b.x < seg.x+15 && b.y > seg.y-20 && b.y < seg.y+20) {

seg.alive = false; createExplosion(seg.x, seg.y, 'rainbow', 40); AudioSys.sfxExplode();

score+=5; document.getElementById('score-board').innerText = score; hit = true;

}

});

}

if (hit || b.x > canvas.width) { bullets.splice(i, 1); i--; }

}

}


function createExplosion(x, y, color, amount) {

for(let i=0; i<amount; i++) particles.push({ x: x, y: y, vx: (Math.random()-0.5)*15, vy: (Math.random()-0.5)*15, life: 1.0, color: color, rainbow: color==='rainbow' });

}

function updateParticles() {

for(let i = 0; i < particles.length; i++) {

let p = particles[i]; p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life -= 0.02;

let c = p.color; if (p.rainbow) c = `hsl(${Math.random()*360}, 100%, 60%)`;

ctx.globalAlpha = p.life; ctx.fillStyle = c; ctx.fillRect(p.x, p.y, 4, 4);

if(p.life <= 0) { particles.splice(i, 1); i--; }

}

ctx.globalAlpha = 1;

}


// --- MAIN ---

function tapAction(e) {

if(e) e.preventDefault();

// Kích hoạt âm thanh ở lần chạm đầu tiên (Do chính sách trình duyệt)

AudioSys.init();

if (gameState === 'START') { gameState = 'PLAYING'; document.getElementById('start-msg').style.display = 'none'; bird.flap(); }

else if (gameState === 'PLAYING') bird.flap();

}

window.addEventListener('mousedown', tapAction);

window.addEventListener('touchstart', tapAction, {passive: false});

window.addEventListener('keydown', (e) => { if(e.code === 'Space') tapAction(); });


function loop() {

ctx.fillStyle = "#020205"; ctx.fillRect(0, 0, canvas.width, canvas.height);

ctx.fillStyle = '#fff'; if(Math.random() < 0.1) ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 2, 2);


if (gameState === 'START') {

bird.y = canvas.height/2 + Math.sin(frames*0.1)*5; bird.draw();

ctx.fillStyle = '#222'; ctx.fillRect(0, canvas.height-20, canvas.width, 20); frames++;

}

else if (gameState === 'PLAYING') {

pipes.update(); pipes.draw();

updateItems(gunItems, 'gun');

updateItems(shieldItems, 'shield');

snakeBoss.updateAndDraw();

bird.update(); bird.draw();

updateBullets(); updateParticles();

ctx.fillStyle = '#222'; ctx.fillRect(0, canvas.height-20, canvas.width, 20); frames++;

}

else if (gameState === 'OVER') {

pipes.draw(); bird.draw(); updateParticles();

if(snakeBoss.active) snakeBoss.updateAndDraw();

ctx.fillStyle = '#222'; ctx.fillRect(0, canvas.height-20, canvas.width, 20);

}

requestAnimationFrame(loop);

}


function gameOver() {

if(gameState === 'OVER') return;

gameState = 'OVER'; createExplosion(bird.x, bird.y, '#ffcc00', 50);

AudioSys.sfxDie(); // Âm thanh chết

document.getElementById('final-score').innerText = score;

document.getElementById('game-over').style.display = 'block';

document.getElementById('score-board').style.display = 'none';

}


function resetGame() {

bird.y = 150; bird.speed = 0; bird.gunTimer = 0; bird.shieldTimer = 0;

pipes.reset(); bullets = []; particles = []; gunItems = []; shieldItems = [];

snakeBoss.active = false; snakeBoss.timer = 600;

score = 0; frames = 0; gameState = 'START';

document.getElementById('score-board').innerText = 0;

document.getElementById('score-board').style.display = 'block';

document.getElementById('game-over').style.display = 'none';

document.getElementById('start-msg').style.display = 'block';

}

loop();

</script>

</body>

</html> 
