<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Th·ª≠ th√°ch t√¨nh y√™u V7 - Full Sound</title>
<style>
    body {
        margin: 0; height: 100vh;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        background-color: #ffe6e6; font-family: 'Arial', sans-serif;
        overflow: hidden; touch-action: none; user-select: none;
        transition: background-color 0.5s;
    }

    h1 {
        color: #ff3366; text-align: center; font-size: 24px;
        margin-bottom: 50px; padding: 0 20px; line-height: 1.5;
        position: absolute; top: 10%; width: 100%; pointer-events: none;
        transition: transform 0.2s;
    }

    .btn-container {
        position: relative; width: 100%; height: 100%;
        display: flex; justify-content: center; align-items: center;
    }

    button {
        padding: 15px 30px; font-size: 18px; font-weight: bold;
        border: none; border-radius: 50px; cursor: pointer;
        font-family: inherit; position: absolute;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        max-width: 80%; white-space: normal;
    }

    #btn-yes { background-color: #ff0055; color: white; z-index: 10; border: 4px solid white; }
    #btn-no { background-color: #fff; color: #555; top: 65%; }

    #success-msg {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: transparent; z-index: 1000;
        flex-direction: column; justify-content: center; align-items: center;
        color: #FFD700; text-align: center;
        text-shadow: 0 0 10px rgba(0,0,0,0.8);
    }
    #success-msg h2 { font-size: 40px; margin-bottom: 20px; text-shadow: 0 0 20px red, 0 0 5px white; animation: bounce 1s infinite; }
    #success-msg p { color: white; font-size: 20px; margin: 10px; font-weight: bold; }
    @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

</style>
</head>
<body>

    <h1 id="main-title">Th·∫£o ∆°i, l√†m ng∆∞·ªùi y√™u B√¨nh nha?<br>ü•∫üëâüëà</h1>

    <div class="btn-container">
        <button id="btn-yes" onpointerdown="xuLyYes(event)">ƒê·ªìng √Ω lu√¥n! ‚ù§Ô∏è</button>
        <button id="btn-no" onpointerdown="xuLyNo(event)">Kh√¥ng bao gi·ªù üòù</button>
    </div>

    <div id="success-msg">
        <h2>CH·ªêT ƒê∆†N! ü•∞</h2>
        <p>Ph·∫£i ki√™n tr√¨ l·∫Øm m·ªõi ƒë∆∞·ª£c ƒë√≥!</p>
        <p>Th·∫£o ƒë√£ thu·ªôc v·ªÅ B√¨nh!</p>
        <p>‚ù§Ô∏è LOVE YOU ‚ù§Ô∏è</p>
    </div>

    <canvas id="fireworks" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:999; display:none; background: rgba(0,0,0,0.85);"></canvas>

    <script>
        const btnYes = document.getElementById('btn-yes');
        const btnNo = document.getElementById('btn-no');
        const title = document.getElementById('main-title');
        const successScreen = document.getElementById('success-msg');
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');

        let yesTapCount = 0; const YES_MAX_TAPS = 10; 
        let noTapCount = 0;
        const noPhrases = [
            "Kh√¥ng bao gi·ªù üòù", "ƒê·ª´ng t·ª´ ch·ªëi m√† nƒÉn n·ªâ ƒë√≥ üò¢", "Van xin m√†, ƒë·ª´ng t·ª´ ch·ªëi m√† üò≠",
            "Th·∫£o n·ª° l√†m B√¨nh bu·ªìn sao? üíî", "Tim anh v·ª° tan t√†nh r·ªìi n√®... ü©π",
            "Th√¥i m√†, th∆∞∆°ng anh ƒëi... ü•∫", "H√îNG CHO B·∫§M N·ªÆA! üò°"
        ];

        const AudioSys = {
            ctx: null,
            init: function() { if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)(); if (this.ctx.state === 'suspended') this.ctx.resume(); },
            playSad: function() { if (!this.ctx) return; const o = this.ctx.createOscillator(); const g = this.ctx.createGain(); o.type = 'triangle'; o.frequency.setValueAtTime(300, this.ctx.currentTime); o.frequency.linearRampToValueAtTime(100, this.ctx.currentTime + 0.5); g.gain.setValueAtTime(0.1, this.ctx.currentTime); g.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 0.5); o.connect(g); g.connect(this.ctx.destination); o.start(); o.stop(this.ctx.currentTime + 0.5); },
            playCharge: function(count) { if (!this.ctx) return; const o = this.ctx.createOscillator(); const g = this.ctx.createGain(); o.type = 'sawtooth'; let freq = 150 + (count * 80); o.frequency.setValueAtTime(freq, this.ctx.currentTime); o.frequency.linearRampToValueAtTime(freq + 100, this.ctx.currentTime + 0.1); g.gain.setValueAtTime(0.1, this.ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3); o.connect(g); g.connect(this.ctx.destination); o.start(); o.stop(this.ctx.currentTime + 0.3); },
            playWin: function() { if (!this.ctx) return; const notes = [523, 659, 784, 1046, 1318]; notes.forEach((n, i) => { const o = this.ctx.createOscillator(); const g = this.ctx.createGain(); o.type = 'square'; o.frequency.value = n; g.gain.value = 0.1; g.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + i*0.1 + 0.5); o.connect(g); g.connect(this.ctx.destination); o.start(this.ctx.currentTime + i*0.1); o.stop(this.ctx.currentTime + i*0.1 + 0.5); }); },
            
            // --- TH√äM TI·∫æNG PH√ÅO HOA N·ªî B√ôM ---
            playFirework: function() {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                // Gi·∫£ l·∫≠p ti·∫øng n·ªï b·∫±ng s√≥ng Sawtooth tr·∫ßm
                osc.type = 'sawtooth';
                // T·∫ßn s·ªë ng·∫´u nhi√™n cho m·ªói qu·∫£ n·ªï kh√°c nhau x√≠u
                let freq = 80 + Math.random() * 100;
                osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(10, this.ctx.currentTime + 0.5); // H·∫° th·∫•p d·∫ßn (ti·∫øng r·ªÅn)
                
                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.5); // T·∫Øt d·∫ßn

                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.5);
            }
        };

        function xuLyNo(e) {
            if(e) e.preventDefault(); AudioSys.init(); noTapCount++;
            if (noTapCount < noPhrases.length - 1) {
                btnNo.innerText = noPhrases[noTapCount]; AudioSys.playSad();
                const x = (Math.random() - 0.5) * 50; const y = (Math.random() - 0.5) * 50;
                btnNo.style.transform = `translate(${x}px, ${y}px)`;
                let scaleYes = 1 + (noTapCount * 0.1); btnYes.style.transform = `scale(${scaleYes})`;
                document.body.style.backgroundColor = `rgba(255, ${230 - noTapCount*30}, ${230 - noTapCount*30}, 1)`;
            } else {
                btnNo.innerText = noPhrases[noPhrases.length - 1];
                const w = window.innerWidth - 100; const h = window.innerHeight - 100;
                const x = Math.random() * w - w/2; const y = Math.random() * h - h/2;
                btnNo.style.position = "fixed"; btnNo.style.left = "50%"; btnNo.style.top = "50%";
                btnNo.style.transform = `translate(${x}px, ${y}px)`;
            }
        }

        function xuLyYes(e) {
            if(e) e.preventDefault(); AudioSys.init(); yesTapCount++;
            if (yesTapCount < YES_MAX_TAPS) {
                AudioSys.playCharge(yesTapCount); if (navigator.vibrate) navigator.vibrate(50 * yesTapCount);
                let scale = 1 + (yesTapCount * 0.2); let bonusScale = noTapCount * 0.1; 
                btnYes.style.transform = `scale(${scale + bonusScale})`;
                let r = 255 - (yesTapCount * 10); btnYes.style.backgroundColor = `rgb(255, ${r}, ${r})`;
                if (yesTapCount == 1) btnYes.innerText = "Ch∆∞a ƒë∆∞·ª£c ƒë√¢u!";
                if (yesTapCount == 3) btnYes.innerText = "M·∫°nh n·ªØa l√™n!";
                if (yesTapCount == 6) btnYes.innerText = "S·∫ÆP ƒê∆Ø·ª¢C R·ªíI!!";
                if (yesTapCount == 9) btnYes.innerText = "C√ÅI CU·ªêI C√ôNG!!!";
                title.style.transform = `rotate(${Math.random()*10 - 5}deg)`;
            } else { finish(); }
        }

        function finish() {
            if (navigator.vibrate) navigator.vibrate([200, 100, 200, 100, 500]); AudioSys.playWin();
            successScreen.style.display = 'flex'; canvas.style.display = 'block';
            startFireworks();
        }

        let particles = [];
        function startFireworks() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            loop();
        }

        function createHeartFirework() {
            const cx = Math.random() * canvas.width * 0.8 + canvas.width * 0.1;
            const cy = Math.random() * canvas.height * 0.5 + canvas.height * 0.1;
            const color = `hsl(${330 + Math.random() * 40}, 100%, 60%)`; 
            const numParticles = 60;
            
            // K√≠ch ho·∫°t √¢m thanh n·ªï
            AudioSys.playFirework();

            for (let i = 0; i < numParticles; i++) {
                const t = (Math.PI * 2 * i) / numParticles;
                const scale = 0.5;
                const vx = (16 * Math.pow(Math.sin(t), 3)) * scale;
                const vy = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t)) * scale;
                particles.push({ x: cx, y: cy, vx: vx, vy: vy, life: 120 + Math.random()*30, color: color, gravity: 0.04 });
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.globalCompositeOperation = 'lighter';

            if (Math.random() < 0.04) createHeartFirework();

            for (let i = 0; i < particles.length; i++) {
                let p = particles[i]; p.x += p.vx; p.y += p.vy; p.vy += p.gravity; p.life--;
                ctx.beginPath(); ctx.fillStyle = p.color;
                let size = (p.life > 100) ? 3 : (Math.random() > 0.5 ? 2.5 : 1.5);
                ctx.arc(p.x, p.y, size, 0, Math.PI*2); ctx.fill();
                if (p.life <= 0) { particles.splice(i, 1); i--; }
            }
        }
    </script>

</body>
</html>
